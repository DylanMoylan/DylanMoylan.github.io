"use strict";(self["webpackChunksltr"]=self["webpackChunksltr"]||[]).push([[307],{3307:(e,t,o)=>{o.r(t),o.d(t,{default:()=>k});o(71);var i=o(3673),n=o(8880),r=o(2323);const a={class:"row q-mt-md"},d=["innerHTML"],s={class:"empty-pane",style:{position:"relative"}},c={class:"row q-mt-md"},l=["onMouseenter"],h={class:"row justify-center"},u=["onMouseenter"];function m(e,t,o,m,p,v){const w=(0,i.up)("card"),H=(0,i.up)("q-page");return(0,i.wg)(),(0,i.j4)(H,{class:"bg-positive"},{default:(0,i.w5)((()=>[(0,i._)("div",{class:"row full-width justify-between q-mb-md",onClick:t[3]||(t[3]=(0,n.iM)((e=>p.cardHeld=null),["stop"]))},[(0,i._)("div",a,[(0,i._)("div",{class:(0,r.C_)(["q-ml-md q-mr-md  non-selectable",p.deck.length?"sltr-card":"empty-pane"]),innerHTML:p.deck.length?"ðŸ‚ ":"",onClick:t[0]||(t[0]=(...e)=>v.draw&&v.draw(...e))},null,10,d),(0,i._)("div",s,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(p.drawn,((e,t)=>((0,i.wg)(),(0,i.j4)(w,{card:e,index:t,cardPosition:t,location:"drawn",pile:p.drawn,key:`drwc${t}`,onMoveCard:e=>v.moveCard(e,"drawn",null,t),onMoveCardTo:v.moveCardTo,onHoldCard:v.holdCard,onCardHovered:v.cardHovered,cardHeld:p.cardHeld,left:p.left,top:p.top},null,8,["card","index","cardPosition","pile","onMoveCard","onMoveCardTo","onHoldCard","onCardHovered","cardHeld","left","top"])))),128))])]),(0,i._)("div",c,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(p.foundation,((e,o)=>((0,i.wg)(),(0,i.iD)("div",{key:`fp${o}`,class:"empty-pane",style:{position:"relative"},onMousedown:t[1]||(t[1]=(...e)=>v.moveCardTo&&v.moveCardTo(...e)),onMouseleave:t[2]||(t[2]=e=>v.cardHovered(null)),onMouseenter:e=>v.cardHovered({cardPosition:o,location:"foundation",index:0,card:{number:0,color:"any",suite:"any"}})},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e,((t,n)=>((0,i.wg)(),(0,i.j4)(w,{card:t,pile:e,index:n,cardPosition:o,location:"foundation",key:`fn${o}-${n}`,onMoveCardTo:v.moveCardTo,onHoldCard:v.holdCard,onCardHovered:v.cardHovered,cardHeld:p.cardHeld,left:p.left,top:p.top},null,8,["card","pile","index","cardPosition","onMoveCardTo","onHoldCard","onCardHovered","cardHeld","left","top"])))),128))],40,l)))),128))])]),(0,i._)("div",h,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(p.tableau,((e,o)=>((0,i.wg)(),(0,i.iD)("div",{key:`tn${o}`,class:"empty-pane",style:{position:"relative"},onMousedown:t[4]||(t[4]=(...e)=>v.moveCardTo&&v.moveCardTo(...e)),onMouseenter:e=>v.cardHovered({cardPosition:o,location:"tableau",index:0,card:{number:14,color:"any"}}),onMouseleave:t[5]||(t[5]=e=>v.cardHovered(null))},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e,((t,n)=>((0,i.wg)(),(0,i.j4)(w,{card:t,pile:e,index:n,cardPosition:o,location:"tableau",key:`tn${o}-${n}`,onMoveCard:e=>v.moveCard(e,"tableau",o,n),onMoveCardTo:v.moveCardTo,onHoldCard:v.holdCard,onCardHovered:v.cardHovered,cardHeld:p.cardHeld,left:p.left,top:p.top},null,8,["card","pile","index","cardPosition","onMoveCard","onMoveCardTo","onHoldCard","onCardHovered","cardHeld","left","top"])))),128))],40,u)))),128))])])),_:1})}const p={methods:{createDeck(){let e=[];const t={heart:{icon:"127152",color:"red"},diamond:{icon:"127168",color:"red"},spade:{icon:"127136",color:"black"},club:{icon:"127184",color:"black"}},o=(e,o)=>{let i={1:"Ace",11:"Jack",12:"Queen",13:"King"};return{number:e,face:i[e]?i[e]:null,suite:o,color:t[o].color,icon:e<12?`&#${parseInt(t[o].icon)+parseInt(e)};`:`&#${parseInt(t[o].icon)+parseInt(e)+1};`,shown:!1}},i=t=>{for(let i=1;i<14;i++)e.push(o(i,t))};function n(e){var t,o=e.length;while(0!=o)t=Math.floor(Math.random()*o),o--,[e[o],e[t]]=[e[t],e[o]];return e}Object.keys(t).forEach((e=>i(e))),this.deck=n(e)},createTestDeck(){let e=[];const t={heart:{icon:"127152",color:"red"},diamond:{icon:"127168",color:"red"},spade:{icon:"127136",color:"black"},club:{icon:"127184",color:"black"}},o=(e,o)=>{let i={1:"Ace",11:"Jack",12:"Queen",13:"King"};return{number:e,face:i[e]?i[e]:null,suite:o,color:t[o].color,icon:e<12?`&#${parseInt(t[o].icon)+parseInt(e)};`:`&#${parseInt(t[o].icon)+parseInt(e)+1};`,shown:!1}},i=t=>{for(let i=1;i<14;i++)e.push(o(i,t))};Object.keys(t).forEach((e=>i(e))),this.deck=e,this.tableau=[[o(1,"diamond")],[o(3,"spade"),o(2,"diamond")],[o(3,"heart"),o(4,"heart"),o(3,"diamond")],[],[],[],[]],this.tableau[0][0].shown=!0,this.tableau[1][1].shown=!0,this.tableau[2][2].shown=!0},createTableau(){for(let e=0;e<7;e++){let t=this.deck.splice(0,e+1);this.tableau.push(t),this.tableau[e][this.tableau[e].length-1].shown=!0}}}},v=["innerHTML"];function w(e,t,o,a,d,s){return(0,i.wg)(),(0,i.iD)("div",{style:(0,r.j5)([{color:o.card.shown?o.card.color:"black",position:s.position,left:s.cLeft,"z-index":s.zIndex,top:s.cTop},{overflow:"hidden"}]),onMousedown:t[0]||(t[0]=(0,n.iM)(((...e)=>s.detach&&s.detach(...e)),["stop"])),onMouseup:t[1]||(t[1]=(...e)=>s.attach&&s.attach(...e)),onMouseenter:t[2]||(t[2]=e=>s.hoverCard(!1)),onMouseleave:t[3]||(t[3]=e=>s.hoverCard(!0))},[(0,i._)("div",{innerHTML:o.card.shown?o.card.icon:"ðŸ‚ ",class:"sltr-card non-selectable"},null,8,v)],36)}const H={props:["card","index","location","pile","cardHeld","cardPosition","left","top"],data(){return{detached:!1,clicks:0,delay:150}},methods:{hoverCard(e){this.detached||(e?this.$emit("cardHovered",null):this.$emit("cardHovered",{card:this.card,index:this.index,location:this.location,cardPosition:this.cardPosition}))},moveCard(e){"drawn"!=this.location?e?this.$emit("moveCardTo",this.card):this.$emit("moveCard",this.card):this.pile&&this.index+1==this.pile.length&&this.$emit("moveCard",this.card)},detach(){this.clicks++,this.cardHeld?(this.moveCard(!0),this.clicks=0):1==this.clicks?this.timer=setTimeout((()=>{!this.card.shown||this.index!=this.pile.length-1&&"drawn"==this.location||(this.detached=!0,window.addEventListener("mouseup",this.removeListener),this.$emit("holdCard",{card:this.card,location:this.location,index:this.index,cardPosition:this.cardPosition})),this.clicks=0}),this.delay):(clearTimeout(this.timer),this.moveCard(),this.attach(),this.clicks=0)},attach(){this.detached&&(clearTimeout(this.timer),this.removeListener(),this.$emit("holdCard",null))},removeListener(){this.detached=!1,window.removeEventListener("mouseup",this.removeListener)}},computed:{position(){return this.detached||this.isTiedToCardHeld?"fixed":"absolute"},zIndex(){return"fixed"==this.position?100+this.index+1:this.index+1},cLeft(){return this.detached||this.isTiedToCardHeld?`${this.left+10}px`:"drawn"==this.location&&this.card.shown?25*this.index+"px":0},cTop(){if(this.detached)return`${this.top+10}px`;if(this.isTiedToCardHeld){let e=this.index+1-(this.cardHeld.index+1);return`${this.top+25*e+10}px`}return"tableau"==this.location?this.card.shown?25*this.index-10*this.shownInPile+"px":10*this.index+"px":0},isTiedToCardHeld(){return!!this.cardHeld&&this.card.shown&&this.location==this.cardHeld.location&&this.cardPosition==this.cardHeld.cardPosition&&this.index>=this.cardHeld.index},shownInPile(){if(this.pile)return this.pile.filter((e=>!e.shown)).length}}};H.render=w;const f=H,b={components:{Card:f},props:{reset:Boolean,score:Number},name:"PageIndex",mixins:[p],data(){return{foundation:[[],[],[],[]],deck:[],tableau:[],drawn:[],cardHeld:null,cardHovering:null,left:0,top:0}},methods:{cardHovered(e){this.cardHovering=e},draw(){this.deck.length?this.drawn.push(...this.deck.splice(0,3).map((e=>(e.shown=!0,e)))):(this.deck=[...this.drawn.map((e=>(e.shown=!1,e)))],this.drawn=[]),this.cardHeld=null},holdCard(e){this.cardHeld=e},moveCardTo(){if(this.cardHeld){let e,t,o,i,n=[];e="drawn"==this.cardHeld.location?this.drawn:this[this.cardHeld.location][this.cardHeld.cardPosition],t=this.cardHovering.location,o=this[t][this.cardHovering.cardPosition],i=this.cardHovering.card,"foundation"==t?this.cardHeld.card.number!=i.number+1||i.suite!=this.cardHeld.card.suite&&"any"!=i.suite||this.cardHeld.index!=e.length-1&&"drawn"!=this.cardHeld.card.location||(n=e.splice(this.cardHeld.index,e.length),n.forEach((e=>o.push(e))),this.$emit("update:score",this.score+10),e.length&&(e[e.length-1].shown=!0,this.$emit("update:score",this.score+5))):(!i&&13==this.cardHeld.card.number||i.color!=this.cardHeld.card.color&&i.number==this.cardHeld.card.number+1)&&(n=e.splice(this.cardHeld.index,e.length),n.forEach((e=>o.push(e))),"foundation"==this.cardHeld.location?this.$emit("update:score",this.score-15):e.length&&(e[e.length-1].shown=!0,this.$emit("update:score",this.score+5)))}this.cardHeld=null},moveCard(e,t,o,i){let n,r,a;a="drawn"==t?this.drawn:this[t][o];let d=this.tableauRequirements.find((t=>(t.color==e.color||"any"==t.color)&&t.number==e.number));a.length==i+1&&(r=this.foundationRequirements.find((t=>("any"==t.suite||t.suite==e.suite)&&e.number==t.number))),(r||d)&&(n="drawn"==t?[this.drawn.pop()]:this[t][o].splice(i,this[t][o].length-i+1),"tableau"==t&&this[t][o].length&&(this[t][o][this[t][o].length-1].shown=!0,this.$emit("update:score",this.score+5))),d&&r?1==e.number||2==e.number||13==e.number&&"tableau"==t?(n.forEach((e=>this[r.location][r.index].push(e))),setTimeout((()=>{this.$emit("update:score",this.score+10)}),500)):("drawn"==t&&this.$emit("update:score",this.score+5),n.forEach((e=>this[d.location][d.index].push(e)))):d?("drawn"==t&&this.$emit("update:score",this.score+5),n.forEach((e=>this[d.location][d.index].push(e)))):r&&(n.forEach((e=>this[r.location][r.index].push(e))),this.$emit("update:score",this.score+10))},watchPosition(e){this.left=e.clientX,this.top=e.clientY},doReset(){this.deck=[],this.tableau=[],this.drawn=[],this.foundation=[[],[],[],[]],this.createDeck(),this.createTableau(),this.$emit("update:score",0)}},computed:{victory(){return this.foundation.every((e=>13==e.length))},tableauRequirements(){return this.tableau.map(((e,t)=>{if(e.length){let o=e[e.length-1];return{color:"black"==o.color?"red":"black",number:o.number-1,location:"tableau",index:t}}return{color:"any",number:13,location:"tableau",index:t}}))},foundationRequirements(){return this.foundation.map(((e,t)=>e.length?{suite:e[0].suite,number:e.length+1,location:"foundation",index:t}:{suite:"any",number:1,location:"foundation",index:t}))}},watch:{reset(e){this.doReset()},victory(e){e&&this.$q.dialog({title:"Victory!",message:`You win! Score: ${this.score}. Start new game?`,cancel:!0}).onOk((e=>this.doReset()))}},mounted(){this.createDeck(),this.createTableau(),this.$emit("update:score",0),window.addEventListener("mousemove",this.watchPosition)},beforeDestroy(){window.removeEventListener("mousemove",this.watchPosition)}};var C=o(4379),g=o(7518),x=o.n(g);b.render=m;const k=b;x()(b,"components",{QPage:C.Z})}}]);